angular.module("countDown",[]).directive("countdown",["$timeout",function(t){return{restrict:"EA",scope:{status:"=",time:"="},link:function(n,s,e){function a(){s.removeClass("disabled"),s.removeAttr("disabled"),s.html(d),t.cancel(c),r=-1,n.status="end"}function u(){return r>0?function(){n.status="running"}:(n.status="running",r=n.time,s.addClass("disabled"),s.attr("disabled","disabled"),o())}function o(){var e=--r;return"stop"===n.status?a():(s.text(l[0]+parseInt(e/60)+"分"+e%60+"秒"+l[1]),r>0?void(i=t(o,1e3)):a())}var r,c,d=s.html(),l=e.tpl?e.tpl.split("?time"):["倒计时","秒"];s.on("click",u),n.$watch("status",function(t){"start"===t&&u(),"stop"===t&&a()}),n.$on("$destroy",function(){c&&t.cancel(c)})}}}]);